* Test LTSPICE diode

.SUBCKT TESTDIODE A C

*DBODY A C DTEST



*.param varepsilon = {TABLE(V(A,C),0,3.9716,5,3.9716)}
*.model DTEST D( epsilon=varepsilon Ron=0.0417 Vfwd=3.0430)

.FUNC PAR_EPS(V) {TABLE(V,-5,4.1569,0,2.7642,5,1.8487,10,0.6376,15,0.15779,20,0.0137)}
.FUNC PAR_RON(V) {TABLE(V,-5,0.046152,0,0.11078,5,0.10099,10,0.094408,15,0.076227,20,0.064828)}
.FUNC PAR_VFW(V) {TABLE(V,-5,2.8794,0,1.325,5,0.30711,10,2.8783e-14,15,1.463e-09,20,0.025041)}

B1 A C I=if(V(A,C)-PAR_VFW(V(A,C))<=0, 0, 
+		(V(A,C)-PAR_VFW(V(A,C)))**2/(2*PAR_EPS(V(A,C))*PAR_RON(V(A,C))))
*+		 V(A,C)-PAR_VFW(V(A,C))>0)

.ENDS TESTDIODE